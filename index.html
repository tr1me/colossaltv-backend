<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>COLOSSALTV Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #eee; text-align: center; }
    button { margin: 10px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
    input { padding: 8px; margin: 10px; }
    #result { margin-top: 20px; font-size: 18px; color: #0f0; }
  </style>
</head>
<body>
  <h1>COLOSSALTV Dashboard</h1>
  <button id="addProfileBtn">Add Profile</button>
  <button id="revokeBtn">Revoke Access</button>
  <button id="restoreBtn">Restore Access</button>
  <button id="rotateKeyBtn">Rotate API Key</button>
  <br>
  <input type="text" id="searchInput" placeholder="Enter profile name">
  <button id="searchBtn">Search Profile</button>
  <div id="result"></div>

  <script>
    const API_BASE = "http://localhost:3000"; 
    // Replace with Fly.io URL once deployed, e.g. "https://colossaltv-service.fly.dev"

    // Add Profile
    document.getElementById("addProfileBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/profile`, { method: "POST" })
        .then(res => res.json())
        .then(data => {
          document.getElementById("result").innerText = `‚úÖ Profile "${data.profile.name}" added`;
        })
        .catch(() => document.getElementById("result").innerText = "‚ùå Failed to add profile");
    });

    // Revoke Access
    document.getElementById("revokeBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/revoke`, { method: "POST" })
        .then(res => res.json())
        .then(data => {
          document.getElementById("result").innerText = `üö´ Access revoked for ${data.profile.name}`;
        })
        .catch(() => document.getElementById("result").innerText = "‚ùå Failed to revoke access");
    });

    // Restore Access
    document.getElementById("restoreBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/restore`, { method: "POST" })
        .then(res => res.json())
        .then(data => {
          document.getElementById("result").innerText = `‚úÖ Access restored for ${data.profile.name}`;
        })
        .catch(() => document.getElementById("result").innerText = "‚ùå Failed to restore access");
    });

    // Rotate API Key
    document.getElementById("rotateKeyBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/rotate-key`, { method: "POST" })
        .then(res => res.json())
        .then(data => {
          document.getElementById("result").innerText = `üîë New API Key: ${data.apiKey}`;
        })
        .catch(() => document.getElementById("result").innerText = "‚ùå Failed to rotate key");
    });

    // Search Profile
    document.getElementById("searchBtn").addEventListener("click", () => {
      const name = document.getElementById("searchInput").value;
      fetch(`${API_BASE}/profile/${name}`)
        .then(res => {
          if (!res.ok) throw new Error("Profile not found");
          return res.json();
        })
        .then(data => {
          document.getElementById("result").innerText = `‚úÖ Found profile: ${data.profile.name}, Status: ${data.profile.status}`;
        })
        .catch(() => document.getElementById("result").innerText = "‚ùå Profile not found");
    });
  </script>
</body>
</html>
