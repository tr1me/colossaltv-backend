<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>COLOSSALTV Dashboard</title>
</head>
<body>
  <h1>COLOSSALTV Dashboard</h1>

  <button id="addProfileBtn">Add Profile</button>
  <button id="revokeBtn">Revoke Access</button>
  <button id="restoreBtn">Restore Access</button>
  <button id="rotateKeyBtn">Rotate API Key</button>

  <br><br>
  <input type="text" id="searchInput" placeholder="Enter profile name">
  <button id="searchBtn">Search Profile</button>

  <script>
    const API_BASE = "http://localhost:3000"; 
    // Replace with Fly.io URL once deployed

    // Add Profile
    document.getElementById("addProfileBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/profile`, { method: "POST" })
        .then(res => res.json())
        .then(data => alert(`‚úÖ Profile "${data.profile.name}" added`))
        .catch(() => alert("‚ùå Failed to add profile"));
    });

    // Revoke Access
    document.getElementById("revokeBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/revoke`, { method: "POST" })
        .then(res => res.json())
        .then(data => alert(`üö´ Access revoked for ${data.profile.name}`))
        .catch(() => alert("‚ùå Failed to revoke access"));
    });

    // Restore Access
    document.getElementById("restoreBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/restore`, { method: "POST" })
        .then(res => res.json())
        .then(data => alert(`‚úÖ Access restored for ${data.profile.name}`))
        .catch(() => alert("‚ùå Failed to restore access"));
    });

    // Rotate API Key
    document.getElementById("rotateKeyBtn").addEventListener("click", () => {
      fetch(`${API_BASE}/rotate-key`, { method: "POST" })
        .then(res => res.json())
        .then(data => alert(`üîë New API Key: ${data.apiKey}`))
        .catch(() => alert("‚ùå Failed to rotate key"));
    });

    // üîç Search Profile
    document.getElementById("searchBtn").addEventListener("click", () => {
      const name = document.getElementById("searchInput").value;
      fetch(`${API_BASE}/profile/${name}`)
        .then(res => {
          if (!res.ok) throw new Error("Profile not found");
          return res.json();
        })
        .then(data => alert(`‚úÖ Found profile: ${data.profile.name}, Status: ${data.profile.status}`))
        .catch(() => alert("‚ùå Profile not found"));
    });
  </script>
</body>
</html>
